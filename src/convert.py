# https://www.sciencedirect.com/science/article/abs/pii/S0098300423001188?via%3Dihub

# https://disk.yandex.ru/d/KapicF_MEysifg

import ast
import csv
import glob
import os
import shutil
from urllib.parse import unquote, urlparse

import numpy as np
import supervisely as sly
from dotenv import load_dotenv
from supervisely.io.fs import (
    file_exists,
    get_file_name,
    get_file_name_with_ext,
    get_file_size,
)
from tqdm import tqdm

import src.settings as s
from dataset_tools.convert import unpack_if_archive


def fix_masks(image_np: np.ndarray) -> np.ndarray:
    lower_bound = np.array([200, 200, 200])
    upper_bound = np.array([255, 255, 255])
    condition_white = np.logical_and(
        np.all(image_np >= lower_bound, axis=2), np.all(image_np <= upper_bound, axis=2)
    )

    lower_bound = np.array([0, 0, 0])
    upper_bound = np.array([20, 20, 20])
    condition_black = np.logical_and(
        np.all(image_np >= lower_bound, axis=2), np.all(image_np <= upper_bound, axis=2)
    )

    image_np[np.where(condition_white)] = (255, 255, 255)
    image_np[np.where(condition_black)] = (0, 0, 0)

    return image_np


def count_files(path, extension):
    count = 0
    for root, dirs, files in os.walk(path):
        for file in files:
            if file.endswith(extension):
                count += 1
    return count


def convert_and_upload_supervisely_project(
    api: sly.Api, workspace_id: int, project_name: str
) -> sly.ProjectInfo:
    # project_name = "minerals 2023"
    all_images_pathes = "/home/grokhi/rawdata/mineral-image-5k/Minerals_2023/data"
    segm_images_path = "/home/grokhi/rawdata/mineral-image-5k/Minerals_2023/segm/img"
    ds_name = "ds"
    batch_size = 30

    bboxes_path = "/home/grokhi/rawdata/mineral-image-5k/Minerals_2023/minerals_full.csv"
    masks_dir = "/home/grokhi/rawdata/mineral-image-5k/Minerals_2023/segm/mask"
    sizes_path = "/home/grokhi/rawdata/mineral-image-5k/Minerals_2023/minerals_size.csv"

    rus_to_eng_names = {
        "Стибнит": "Stibnite",
        "Велерит": "Welerite",
        "Скуттерудит": "Skutterudite",
        "Йортдалит": "Yortdalite",
        "Гринокит": "Greenockite",
        "Англезит": "Anglesite",
        "Галенит": "Galena",
        "Тетраэдрит": "Tetrahedrite",
        "Сильванит": "Sylvanite",
        "Борнит": "Bornite",
        "Иорданит": "Jordanite",
        "Кварц": "Quartz",
        "Рутил": "Rutile",
        "Лироконит": "Lyroconite",
        "кварц": "quartz",
        "Гипс": "Gypsum",
        "Антофиллит": "Anthophyllite",
        "Пирит": "Pyrite",
        "Барит": "Barite",
        "Арсенопирит": "Arsenopyrite",
        "Энаргит": "Enargite",
        "Медь": "Copper",
        "Пироморфит": "Pyromorphite",
        "Флюорит": "Fluorite",
        "Натролит": "Natrolite",
        "Карнотит": "Carnotite",
        "Корунд": "Corundum",
        "Халькантит": "Chalcanthite",
        "Алунит": "Alunite",
        "Флогопит": "Phlogopite",
        "Андалузит": "Andalusite",
        "Гейландит": "Heulandite",
        "Биотит": "Biotite",
        "Сподумен": "Spodumene",
        "Серебро": "Silver",
        "Сассолин": "Sassolin",
        "Олигоклаз": "Oligoclase",
        "Касситерит": "Cassiterite ",
        "Ортоклаз": "Orthoclase",
        "Сфалерит": "Sphalerite",
        "Сильвин": "Sylvin",
        "Хризоберилл": "Chrysoberyl",
        "Аурихальцит": "Aurichalcite",
        "Клиноцоизит": "Clinozoisite",
        "Галит": "Halite",
        "Магнетит": "Magnetite",
        "Цинкит": "Zincite",
        "Магнезит": "Magnesite",
        "Золото": "Gold",
        "Андрадит": "Andradite",
        "Берилл": "Beryl",
        "Ильменит": "Ilmenite",
        "Томсонит": "Thomsonite",
        "Анальцим": "Analcime",
        "Эшинит": "Aeshinite",
        "Линарит": "Linarite",
        "Гроссуляр": "Grossular",
        "Везувиан": "Vesuvian",
        "Нагиагит": "Nagiagite",
        "Перовскит": "Perovskite",
        "Гематит": "Hematite",
        "Анортит": "Anorthite",
        "Станнин": "Stannin",
        "Брукит": "Brookite",
        "Опал": "Opal",
        "Манганит": "Manganite",
        "Родохрозит": "Rhodochrosite",
        "Азурит": "Azurite",
        "Крокоит": "Crocoite",
        "Целестин": "Celestine",
        "Циркон": "Zircon",
        "Эпидот": "Epidote",
        "Альбит": "Albite",
        "Гемиморфит": "Hemimorphite",
        "Хризоколла": "Chrysocolla",
        "Уранпирохлор": "Uranpyrochlore",
        "Ганит": "Ganite",
        "Виттихенит": "Wittichenite",
        "Висмутин": "Bismuthin",
        "Цейнерит": "Zeinerite",
        "Аурипигмент": "Orpiment",
        "Авгит": "Augite",
        "Железо": "Iron",
        "Андезин": "Andesine",
        "Микроклин": "Microcline",
        "Сидерит": "Siderite",
        "Альмандин": "Almandine",
        "Графит": "Graphite ",
        "Молибденит": "Molybdenite",
        "Платина": "Platinum",
        "Топаз": "Topaz",
        "Эльбаит": "Elbaite",
        "Титанит": "Titanite",
        "Вадеит": "Vadeite",
        "Анкилит-(Ce)": "Ankylite-(Ce)",
        "Бурнонит": "Burnonite",
        "Карбонатфторапатит": "Carbonatefluorapatite",
        "Теннантит": "Tennantite",
        "Гиалофан": "Hyalophane",
        "Колусит": "Colusitis",
        "Халькозин": "Chalcocite",
        "Кальцит": "Calcite",
        "Прайсеит": "Priceite",
        "Монацит": "Monazite",
        "Паризит": "Parisite",
        "Нефелин": "Nepheline",
        "Стибиотанталит": "Stibiotantalite",
        "Триплит": "Triplyte",
        "Термонатрит": "Thermonatrite",
        "Висмут": "Bismuth",
        "Клаусталит": "Claustalite",
        "Аргентит": "Argentite",
        "Штромейерит": "Stromeyerite",
        "Аргентопирит": "Argentopyrite",
        "Петцит": "Petzite",
        "Кобальтин": "Cobaltite",
        "Ульманит": "Ulmanite",
        "Кермезит": "Kermesite",
        "Цинкенит": "Zinkenite",
        "Миаргирит": "Miargyrite",
        "Бертьерит": "Bertierite",
        "Джемсонит": "Jamsonite",
        "Айкинит": "Aikinite",
        "Пираргирит": "Pyrargyrite",
        "Стефанит": "Stephanite",
        "Франкеит": "Frankeite",
        "Шпинель": "Spinel",
        "Пиролюзит": "Pyrolusite",
        "Смитсонит": "Smithsonite",
        "Альстонит": "Alstonite",
        "Витерит": "Witherite",
        "Волластонит": "Wollastonite",
        "Кианит": "Kyanite",
        "Ставролит": "Staurolite",
        "Шабазит": "Chabazite",
        "Мусковит": "Muscovite",
        "Стихтит": "Stichtite",
        "Псевдомалахит": "Pseudomalachite ",
        "Скородит": "Skorodite",
        "Оливенит": "Olivenite",
        "Эвксенит-(Y)": "Euxenite-(Y)",
        "Штольцит": "Stoltsite",
        "Криолит": "Cryolite",
        "Козалит": "Cosalite",
        "Пирохлор": "Pyrochlore",
        "Тунгстит": "Tungstite",
        "Иниоит": "Inioite",
        "Бедантит": "Bedantite",
        "Нашатырь": "Ammonia",
        "Эритрин": "Erythrin",
        "Куплетскит": "Kupletskite",
        "Гидроталькит": "Hydrotalcite",
        "Тортвейтит": "Tortveitite",
        "Пирротин": "Pyrrhotite",
        "Гелландит": "Gellandite",
        "Шеелит": "Scheelite",
        "Серендибит": "Serendibite",
        "Бетафит": "Betafit",
        "Реньерит": "Renierite",
        "Торолит": "Thorolite",
        "Чермигит": "Chermigitite",
        "Браннерит": "Brannerite",
        "Людвигит": "Ludwigite ",
        "Цинксилит": "Zinxylite",
        "Власовит": "Vlasovite",
        "Дюмортьерит": "Dumortierite",
        "Сера": "Sulphur",
        "Бетпакдалит": "Betpakdalite",
        "Форстерит": "Forsterite",
        "Бастнезит": "Bastnaesite",
        "Халькопирит": "Chalcopyrite",
        "Вивианит": "Vivianite",
        "Геденбергит": "Hedenbergite",
        "Карбоцернаит": "Carbotsernaite",
        "Эканит": "Ekanite",
        "Берцелианит": "Bertzelianite",
        "Бертрандит": "Bertrandite",
        "Уранмикролит": "Uranmicrolite",
        "Танталэшинит-(Y)": "Tantalashinite-(Y)",
        "Котоит": "Kotoite",
        "Баумгауерит": "Baumgauerite",
        "Куприт": "Cuprite",
        "Казолит": "Kazolite",
        "Ренардит": "Renardite",
        "Раувит": "Rauvit",
        "Андерсонит": "Andersonite",
        "Бустамит": "Bustamite ",
        "Данбурит": "Danburite",
        "Канкринит": "Cancrinite",
        "Миксит": "Mixit",
        "Морденит": "Mordenite",
        "Гентгельвин": "Genthelvin",
        "Боркарит": "Borkarite",
        "Актинолит": "Actinolite",
        "Флюоцерит-(Ce)": "Fluocerite-(Ce)",
        "Галургит": "Galurgite",
        "Лорандит": "Lorandite",
        "Реальгар": "Realgar",
        "Тодорокит": "Todorokit",
        "Гетчеллит": "Getchellite",
        "Родицит": "Rodicite",
        "Датолит": "Datolite",
        "Фенакит": "Phenakite",
        "Магноколумбит": "Magnocolumbite",
        "Отавит": "Otavit",
        "Арагонит": "Aragonite",
        "Вакабаяшилит": "Vakabayashilit",
        "Галхаит": "Galhaite",
        "Лазулит": "Lazulite",
        "Адамин": "Adamin",
        "Воджинит": "Woginite",
        "Колеманит": "Colemanite",
        "Спуррит": "Spurrite ",
        "Галенобисмутит": "Galenobismuthite",
        "Ильменорутил": "Ilmenorutil",
        "Борнеманит": "Bornemanite",
        "Фторапатит": "Fluorapatite",
        "Бетехтинит": "Betechtinite",
        "Диоптаз": "Dioptase",
        "Кубанит": "Cubanite",
        "Баццит": "Bazzit",
        "Корнетит": "Cornetite",
        "Теллуровисмутит": "Tellurovismutite",
        "Мейонит": "Meionite",
        "Стенструпин-(Ce)": "Stenstrupin-( Ce)",
        "Гидромагнезит": "Hydromagnesite",
        "Лейкосфенит": "Leukosphenite",
        "Согдианит": "Sogdianite",
        "Фторапофиллит": "Fluorapophyllite",
        "Даванит": "Davanite",
        "Эльпидит": "Elpidite",
        "Ферберит": "Ferberite",
        "Андорит": "Andorite",
        "Доломит": "Dolomite",
        "Бенстонит": "Benstonite",
        "Меллит": "Mellite",
        "Йордизит": "Jordisite ",
        "Гессит": "Hessite",
        "Жозеит": "Joseite",
        "Калаверит": "Calaverite",
        "Нигерит": "Nigerite",
        "Саффлорит": "Safflorite",
        "Мышьяк": "Arsenic",
        "Тиролит": "Tyrolite",
        "Щербаковит": "Shcherbakovite",
        "Гагаринит-(Y)": "Gagarinite-(Y)",
        "Джерфишерит": "Djerfisherite",
        "Кестерит": "Kesterite",
        "Грейгит": "Greigit",
        "Уваровит": "Uvarovit",
        "Пироп": "Pyrope",
        "Кридит": "Credite",
        "Гаюин": "Gayuin",
        "Купрокопиапит": "Cuprocopiapit",
        "Гидроксилапофиллит": "Hydroxylapophyllite",
        "Брусит": "Brusite",
        "Вавеллит": "Wavellite",
        "Болеит": "Boleit",
        "Бастнезит-(Ce)": "Bastnäsite-(Ce)",
        "Баратовит": "Baratovite",
        "Дарапиозит": "Darapiosite",
        "Еремеевит": "Eremeevite ",
        "Цирсиналит": "Cirsinalit",
        "Паранатролит": "Paranatrolite",
        "Давидит-(La)": "Davidite-(La)",
        "Краутит": "Crautite",
        "Намибит": "Namibite",
        "Джемборит": "Jamborite",
        "Уиллхендерсонит": "Willendersonite",
        "Гускрикит": "Guskrikite",
        "Хизлевудит": "Heaslewoodite",
        "Алабандин": "Alabandine",
        "Плюмбопирохлор": "Plumbopyrochlore",
        "Эвклаз": "Euclase",
        "Акантит": "Acanthite",
        "Селлаит": "Sellaite",
        "Герсдорфит": "Gersdorfit",
        "Мангантанталит": "Mangantantalite",
        "Оленит": "Olenite",
        "Стильбит": "Stilbite",
        "Церит-(Ce)": "Cerite-(Ce)",
        "Розенбушит": "Rosenbushite",
        "Науяказит": "Nauyakasite",
        "Эпистолит": "Epistolite",
        "Галлуазит": "Halloisite ",
        "Диаспор": "Diaspor",
        "Гюбнерит": "Hübnerite",
        "Окенит": "Okenite",
        "Гояцит": "Goyacite",
        "Увит": "Uvit",
        "Тетрадимит": "Tetradymite",
        "Шерл": "Sherl",
        "Кимрит": "Kimrit",
        "Вюртцит": "Wurtzite",
        "Гетероморфит": "Heteromorphite",
        "Вульфенит": "Wulfenite",
        "Лепидолит": "Lepidolite",
        "Фаялит": "Fayalit",
        "Эдингтонит": "Edingtonite",
        "Гамбергит": "Hambergite",
        "Поллуцит": "Pollucite",
        "Манассеит": "Manasseite",
        "Магнетоплюмбит": "Magnetoplumbite",
        "Алтаит": "Altaite",
        "Бурбанкит": "Burbankite",
        "Ковдорскит": "Kovdorskite",
        "Гречищевит": "Grechishchevit",
        "Энигматит": "Enigmatite",
        "Умбозерит": "Umboserite",
        "Гельвин": "Gelvin",
        "Манганотанталит": "Manganotantalite",
        "Артинит": "Artinite",
        "Таумасит": "Taumasite ",
        "Филлипсит": "Phillipsite",
        "Перроит": "Perroite",
        "Доннейит-(Y)": "Donneyite-(Y)",
        "Фенаксит": "Phenaxite",
        "Гайдоннаит": "Haidonnaite",
        "Уранинит": "Uraninite",
        "Пренит": "Prehnite",
        "Нептунит": "Neptunite",
        "Соренсенит": "Sorensenite",
        "Мурманит": "Murmanite",
        "Витусит": "Vitusite",
        "Эпидидимит": "Epididymite",
        "Астрофиллит": "Astrophyllite",
        "Нарсарсукит": "Narsarsukite",
        "Тинкалконит": "Tinkalconite",
        "Пирофанит": "Pyrophanite",
        "Вонсенит": "Vonsenite",
        "Перрудит": "Perrudite",
        "Виноградовит": "Vinogradovite",
        "Свабит": "Svabit",
        "Тилазит": "Tilazit",
        "Макгюйнесит": "Makguinesite",
        "Хондродит": "Chondrodite",
        "Пироксмангит": "Pyroxmangite ",
        "Кукеит": "Kukeit",
        "Норбергит": "Norbergite",
        "Флюоборит": "Fluoborite",
        "Тремолит": "Tremolite",
        "Монтичеллит": "Monticellite",
        "Виллемит": "Willemite",
        "Кутнагорит": "Kutnagorite",
        "Ситинакит": "Sitinakit",
        "Сидоренкит": "Sidorenkit",
        "Паракелдышит": "Parakeldyshit",
        "Мурит": "Murit",
        "Вуориярвит": "Vuoriyarvit",
        "Макговернит": "McGovernit",
        "Либетенит": "Libetenite",
        "Фошагит": "Foshagite",
        "Уайтменит": "Whitemanite",
        "Афтиталит": "Aftitalite",
        "Дуфтит": "Duftite",
        "Бюргерит": "Burgerite",
        "Рокбриджеит": "Rockbridgeite",
        "Шуйскит": "Shuiskite",
        "Инезит": "Inesite",
        "Боромусковит": "Boromuscovite",
        "Гетит": "Goethite",
        "Грюнерит": "Grunerite",
        "Лабунцовит": "Labuntsovite",
        "Броккит": "Brokkite",
        "Мизерит": "Mizerite",
        "Дусматовит": "Dusmatovite",
        "Екатеринит": "Ekaterinite",
        "Годефруаит": "Godefruaite",
        "Холтедалит": "Holtedalite",
        "Сепиолит": "Sepiolite",
        "Атакамит": "Atacamite",
        "Мулуит": "Muluit",
        "Ликазит": "Lycasite",
        "Тенардит": "Thenardite",
        "Дравит": "Dravite",
        "Розиаит": "Rosiaite",
        "Масутомилит": "Masutomilit",
        "Манандонит": "Manandonite",
        "Рейерит": "Reyerite",
        "Стрингхамит": "Stringhamite",
        "Пломбьерит": "Plombierite",
        "Бисмутит": "Bismuthite",
        "Клинотоберморит": "Clinotobermorite",
        "Натисит": "Natisite",
        "Манганоколумбит": "Manganocolumbite",
        "Бобьерит": "Bobierite",
        "Синхизит-(Ce)": "Synchisite-(Ce) ",
        "Шутеит": "Shuteite",
        "Базалюминит": "Basaluminite",
        "Лаудонит": "Laudonite",
        "Алюмофармакосидерит": "Aluminopharmacosiderite",
        "Свитцерит": "Switzerite",
        "Дэлиит": "Delyite",
        "Амезит": "Amesite",
        "Диопсид": "Diopside",
        "Гумбольдтин": "Humboldtine",
        "Алмаз": "Diamond",
        "Летовицит": "Letovicite",
        "Жадеит": "Jadeite",
        "Манганонордит-(Ce)": "Manganonordite-(Ce)",
        "Тальк": "Talc",
        "Клинохлор": "Clinochlore",
        "Роджианит": "Rodgianite",
        "Гаспарит-(Ce)": "Gasparite-(Ce)",
        "Тирагаллоит": "Tyragalloite",
        "Хатчинсонит": "Hutchinsonite",
        "Варламовит": "Varlamovite",
        "Земаннит": "Zemannite",
        "Ферванит": "Fervanite",
        "Крупкаит": "Krupkaite",
        "Малаяит": "Malayaite",
        "Гидроксиапофиллит": "Hydroxyapophyllite ",
        "Бастнезит-(Y)": "Bastnaesite-(Y)",
        "Фосинаит": "Phosinaite",
        "Чевкинит-(Ce)": "Chevkinite-(Ce)",
        "Сажинит-(Ce)": "Sazhinite-(Ce)",
        "Нордит-(Ce)": "Nordite-(Ce)",
        "Джорджчаоит": "Georgechaoite",
        "Стибиконит": "Stibiconite",
        "Клиноэдрит": "Clinohedrite",
        "Эсперит": "Esperite",
        "Гардистонит": "Hardistonite",
        "Бариандит": "Baryandite",
        "Малахит": "Malachite",
        "Гоуерит": "Gowerite",
        "Джинорит": "Ginorite",
        "Лоренценит": "Lorenzenite",
        "Селен": "Selenium",
        "Моганит": "Moganite",
        "Агреллит": "Agrellite",
        "Серандит": "Serandite",
        "Стронцианит": "Strontianite",
        "Церуссит": "Cerussite ",
        "Монацит-(Ce)": "Monazite-(Ce)",
        "Тусканит": "Tuscanite",
        "Фторапофиллит-(K)": "Fluorapophyllite-(K)",
        "Биксбиит": "Bixbyite",
        "Псевдобрукит": "Pseudobrukite",
        "Бенитоит": "Benitoite",
        "Ангидрит": "Anhydrite",
        "Кристобалит": "Cristobalite",
        "Ульманнит": "Ulmannite",
        "Фармаколит": "Pharmacolite",
        "Ершовит": "Ershovit",
        "Бельковит": "Belkovit",
        "Манганотихит": "Manganotikhit",
        "Рощинит": "Roschinit",
        "Литиоводжинит": "Lithiovoginite",
        "Цектцерит": "Tsektserite",
        "Мелифанит": "Melifanite",
        "Бритолит-(Ce)": "Britholite-(Ce)",
        "Гудмундит": "Gudmundite",
        "Джаффеит": "Jaffeite",
        "Хайдарканит": "Khaidarkanite",
        "Чернышит": "Chernyshite",
        "Канкрисилит": "Kankrisilite",
        "Формикаит": "Formikaite",
        "Чемберсит": "Chambersite",
        "Эвхлорин": "Euchlorin",
        "Березанскит": "Berezanskite",
        "Туркестанит": "Turkestanite",
        "Капицаит-(Y)": "Kapitsaite",
        "Алакранит": "Alacranite",
        "Анатаз": "Anataz",
        "Росчерит": "Roscherite",
        "Геленит": "Gehlenite",
        "Гетерогенит": "Heterogenite",
        "Какоксенит": "Cacoxenite",
        "Аурикуприд": "Auricupride",
        "Ибонит": "Ibonite",
        "Гришунит": "Grishunite",
        "Олекминскит": "Olekminskite",
        "Студеницит": "Studenicite",
        "Натрофосфат": "Natrophosphate",
        "Спертиниит": "Spertinite",
        "Улексит": "Ulexite",
        "Гидроксилапатит": "Hydroxylapatite",
        "Рабдофан-(Ce)": "Rabdophane-(Ce)",
        "Гейландит-Sr": "Heulandite-Sr",
        "Гейландит-K": "Heulandite-K",
        "Шабазит-K": "Chabazite-K",
        "Ремондит-(La)": "Remondite-(La)",
        "Анортоклаз": "Anorthoclase",
        "Шкатулкалит": "Shkatulkalite",
        "Маланит": "Malanite",
        "Бауит": "Bauite",
        "Эрликманит": "Erlikmanite",
        "Цезийкуплетскит": "Cesiumkupletskite",
        "Корнерупин": "Kornerupin",
        "Гергейит": "Gergeyite",
        "Вуоннемит": "Vuonnemite",
        "Чкаловит": "Chkalovite",
        "Югаваралит": "Yugavaralite",
        "Висмутомикролит": "Bismuthomicrolite",
        "Римкорольгит": "Rimkorolgite",
        "Непскоеит": "Nepskoite",
        "Давсонит": "Dawsonite",
        "Хошелагаит": "Khoshelagaite",
        "Норсетит": "Norsethite",
        "Лепидокрокит": "Lepidocrocite",
        "Кавансит": "Cavansite",
        "Камеролаит": "Camerolaite",
        "Шлессмахерит": "Schlessmacherite",
        "Гагеит": "Gageite",
        "Эскеборнит": "Eskebornite",
        "Ортошамозит": "Orthoshamosite",
        "Сахаит": "Sakhaite",
        "Йохансенит": "Johansenite",
        "Стиллуэллит-(Ce)": "Stillwellite-(Ce)",
        "Курчатовит": "Kurchatovite",
        "Молибденит-2H": "Molybdenite-2H",
        "Гизингерит": "Giesingerite",
        "Даннеморит": "Dannemorite",
        "Органоваит-Mn": "Organovaite-Mn",
        "Райнхардбраунсит": "Reinhardbraunsite",
        "Родонит": "Rhodonite",
        "Бементит": "Bementite",
        "Спессартин": "Spessartine",
        "Сейдит": "Seydite",
        "Коронадит": "Coronadite",
        "Нантокит": "Nantokite",
        "Костылевит": "Kostylevite",
        "Семеновит": "Semenovit",
        "Дорфманит": "Dorfmanite",
        "Россит": "Rossite",
        "Кузьменкоит-Mn": "Kuzmenkoit-Mn",
        "Сульванит": "Sulvanite",
        "Эгирин": "Aegirine",
        "Гидроксилгердерит": "Hydroxylherderite",
        "Никелин": "Nickelin",
        "Валентинит": "Valentinite",
        "Моттрамит": "Mottramite",
        "Эпистильбит": "Epistilbite",
        "Арсенолит": "Arsenolite",
        "Сенегалит": "Senegalite",
        "Зигенит": "Zigenite",
        "Исовит": "Isovit",
        "Ксонотлит": "Xonotlit",
        "Ривесит": "Rivesite",
        "Леммлейнит-Ba": "Laemmleinite-Ba",
        "Эрионит-K": "Erionite-K",
        "Гейландит-Са": "Heulandite-Sa",
        "Рансьеит": "Ransieit",
        "Джулголдит": "Julgoldite",
        "Киноварь": "Cinnabar",
        "Килхоанит": "Kilchoanite",
        "Содалит": "Sodalite",
        "Пектолит": "Pectolite",
        "Карлетонит": "Carletonite",
        "Ртуть": "Mercury",
        "Кордиерит": "Cordierite",
        "Курнаковит": "Kurnakovite",
        "Дженнит": "Jennite",
        "Эттрингит": "Ettringite",
        "Кристиансенит": "Christiansenite",
        "Стоппаниит": "Stoppaniite",
        "Гемиэдрит": "Hemihedrite",
        "Халькокианит": "Chalcokianite",
        "Йохиллерит": "Johillerite",
        "Ленинградит": "Leningradite",
        "Долерофанит": "Dolerophanite",
        "Декреспигниит-(Y)": "Decrespignite-(Y) ",
        "Лулзацит": "Lulsacite",
        "Бейделлит": "Beidellite",
        "Таканелит": "Takanelit",
        "Сферобертрандит": "Spherobertrandite",
        "Дворникит": "Dvornikite",
        "Гъердингенит-Fe": "Gjerdingenite-Fe",
        "Генримейерит": "Henrimeyerite",
        "Силлиманит": "Sillimanite",
        "Терскит": "Terskite",
        "Бадделеит": "Baddeleyite",
        "Метавивианит": "Metavivianite",
        "Канницарит": "Cannitsarite ",
        "Микролит": "Microlit",
        "Набалампрофиллит": "Nabalamprophyllite",
        "Фекличевит": "Feklichevit",
        "Ферроликеит": "Ferrolykeite",
        "Гидроборацит": "Hydroboracite",
        "Преображенскит": "Preobrazhenskite",
        "Сульфоборит": "Sulfoborite",
        "Калиборит": "Kaliborite",
        "Волконскоит": "Volkonskoite",
        "Марказит": "Marcasite",
        "Повеллит": "Powellite",
        "Барбосалит": "Barbosalite",
        "Шультенит": "Schultenite",
        "Зеелигерит": "Zeeligerite",
        "Годкинсонит": "Godkinsonite",
        "Бахчисарайцевит": "Bakhchisaraitsevite",
        "Цепинит-Ca": "Tsepinite-Ca",
        "Сурьма": "Antimony",
        "Оксаммит": "Oksammit",
        "Джеромит": "Jeromite",
        "Малеевит": "Maleevite",
        "Москвинит-(Y)": "Moskvinite-(Y)",
        "Куспидин": "Kuspidin",
        "Давин": "Davin",
        "Буланжерит": "Boulangerite",
        "Натросилит": "Natrosilit",
        "Клиногумит": "Clinohumite",
        "Гиролит": "Gyrolite",
        "Мезолит": "Mesolite",
        "Сапонит": "Saponite",
        "Бафертисит": "Bafertisite",
        "Русаковит": "Rusakovite",
        "Метахьюэттит": "Metahuettite",
        "Перхамит": "Perhamite",
        "Мелонжозефит": "Melongosephyte",
        "Минасжераисит-(Y)": "Minasgeraisite-(Y)",
        "Лампрофиллит": "Lamprophyllite",
        "Арфведсонит": "Arfvedsonite ",
        "Тинценит": "Tinzenite",
        "Лабунцовит-Fe": "Labuntsovite-Fe",
        "Маггемит": "Maghemite",
        "Яхимовит": "Jachimovite",
        "Церчиараит": "Cerchiaraite",
        "Акрохордит": "Acrochordite",
        "Клиноптилолит": "Clinoptilolite",
        "Аксинит-(Fe)": "Axinite-(Fe)",
        "Лазурит": "Lapis lazuli",
        "Хенмилит": "Chenmilite",
        "Моттанаит-(Ce)": "Mottanaite -(Ce)",
        "Леонит": "Leonite",
        "Цоизит": "Zoisite",
        "Хромит": "Chromite",
        "Тинаксит": "Tinaxite",
        "Стисиит": "Stisiite",
        "Кальсилит": "Kalsilite",
        "Тайниолит": "Tainiolite",
        "Франкаменит": "Frankamenite",
        "Чароит": "Charoite",
        "Фергусонит-(Y)": "Fergusonite-(Y)",
        "Ксенотим-(Y)": "Xenotime-(Y)",
        "Черчит-(Y)": "Churchite-(Y)",
        "Гадолинит-(Y)": "Gadolinite-(Y)",
        "Циннвальдит": "Zinnwaldite",
        "Петарасит": "Petarasite",
        "Тейнеит": "Taineite",
        "Гуанакоит": "Guanacoite",
        "Сингенит": "Syngenite",
        "Лейкофанит": "Leukophanite",
        "Стиллвеллит": "Stillwellite",
        "Капустинит": "Kapustinite",
        "Рениит": "Reniite",
        "Ярандолит": "Yarandolite",
        "Коршуновскит": "Korshunovskite",
        "Ортит-(Ce)": "Ortite-(Ce)",
        "Халькостибит": "Halkostibite",
        "Барбериит": "Barberite",
        "Ниигатаит": "Niigatait",
        "Бацирит": "Batsirite",
        "Боттиноит": "Bottinoit",
        "Леллингит": "Lellingite",
        "Тенорит": "Tenorite",
        "Гармотом": "Garmotom",
        "Гиттинсит": "Gittinsit",
        "Куцтикит": "Kuttikit",
        "Кейвиит-(Yb)": "Keyviit-(Yb)",
        "Чапманит": "Chapmanite",
        "Макатит": "Makatite",
        "Фторкафит": "Ftorkafit ",
        "Катаплеит": "Catapleite",
        "Ферроселадонит": "Ferroseladonite",
        "Литиофосфат": "Lithiophosphate",
        "Россманит": "Rossmanite",
        "Титановоджинит": "Titanovoginite",
        "Битиит": "Bitiite",
        "Панаскейраит": "Panasqueiraite",
        "Лансфордит": "Lansfordite",
        "Виллиомит": "Williamite",
        "Бериллит": "Beryllite",
        "Фосинаит-(Ce)": "Phosinaite-(Ce)",
        "Эвдидимит": "Eudidymite",
        "Аллоклазит": "Alloclasite",
        "Отенит": "Othenite",
        "Пекораит": "Pecoraite",
        "Макгиннессит": "Mcguinnessite",
        "Чесноковит": "Chesnokovite",
        "Лешательерит": "Lechatelierite",
        "Стишовит": "Stishovite",
        "Чаллаколлоит": "Challakolloite",
        "Фторэденит": "Ftoredenite",
        "Фторфлогопит": "Ftorphlogopite",
        "Лабиринтит": "Labyrinthite",
        "Свинец": "Lead ",
        "Гьердингенит-Na": "Gjerdingenite-Na",
        "Левин": "Levin",
        "Кимураит-(Y)": "Kimuraite-(Y)",
        "Моримотоит": "Morimotoite",
        "Такедаит": "Takedaite",
        "Гиллебрандит": "Hillebrandite",
        "Трона": "Trona",
        "Шомиокит-(Y)": "Shomiokit-(Y)",
        "Точилинит": "Tochilinite",
        "Токкоит": "Tokkoit ",
        "Покровскит": "Pokrovskite",
        "Баррингерит": "Barringerite",
        "Ломоносовит": "Lomonosovite",
        "Ссайбелиит": "Ssaybeliite",
        "Хейтманит": "Heitmanit",
        "Канькит": "Kankit",
        "Страшимирит": "Strashimirit",
        "Эссенеит": "Esseneit",
        "Элит": "Elite",
        "Литиофилит": "Lithiofilite",
        "Кудрявит": "Kudryavit",
        "Карасугит": "Karasugit",
        "Неотокит": "Neotokit",
        "Каулсит": "Kaulsite",
        "Стильбит-Na": "Stilbite-Na",
        "Оффретит": "Offretit",
        "Муллит": "Mullite",
        "Амблигонит": "Amblygonite",
        "Мариалит": "Marialite",
        "Накауриит": "Nakauriite",
        "Хогтуваит": "Hogtuvaite",
        "Калиевый ферримагнезиосаданага": "Potassium ferrimagnesiosadagnaga",
        "Браунит": "Brownite",
        "Делафоссит": "Delafossite",
        "Вернадит": "Vernadite",
        "Рамсделлит": "Ramsdellite",
        "Пектолит-M2abc": "Pectolite-M2abc",
        "Метасвитцерит": "Metaswitzerite",
        "Метаварисцит": "Metavariscite",
        "Джоакинит-(Ce)": "Joaquinite-(Ce)",
        "Гроутит": "Groutite",
        "Волластонит-1T": "Wollastonite-1T",
        "Кальциоферрит": "Calcioferrite",
        "Хумберстонит": "Humberstonite",
        "Мендипит": "Mendipite",
        "Монтгомериит": "Montgomeriite",
        "Штретлингит": "Ströttlingite",
        "Тенгерит-(Y)": "Tengerite-(Y)",
        "Паргасит": "Pargasite",
        "Аргентоярозит": "Argentoyarosite",
        "Эвдиалит": "Eudialite",
        "Санидин": "Sanidin",
        "Красновит": "Krasnovit",
        "Витчит": "Whitchit",
        "Твейтит-(Y)": "Tveitite-(Y)",
        "Арроядит": "Arroyadite",
        "Витлокит": "Whitlockite",
        "Довыренит": "Dovyrenit",
        "Пирофиллит": "Pyrophyllite",
        "Линдбергит": " Lindbergite",
        "Литиофорит": "Lithiophorite",
        "Чегемит": "Chegemite",
        "Патронит": "Patronite",
        "Алуноген": "Alunogen",
        "Кренкит": "Krenkite",
        "Фрейбергит": "Freibergite",
        "Семсеит": "Semseite",
        "Ссмикит": "Ssmikit",
        "Куксит": "Kuksite",
        "Калиофилит": "Kaliophylite",
        "Редледжеит": "Redledgeite",
        "Кайнозит-(Y)": "Cenosite-(Y)",
        "Голландит": "Hollandite",
        "Шабазит-Ca": "Chabazite-Ca",
        "Глауберит": "Glauberite",
        "Криптогалит": "Cryptohalite",
        "Керсутит": "Kersutite",
        "Джонсонмервиллеит": "Johnsonmervilleite",
        "Манганонептунит": "Manganoneptunite",
        "Бирюза": "Turquoise",
        "Линдгренит": "Lindgrenite",
        "Антлерит": "Antlerite",
        "Миллерит": "Millerite",
        "Ростит": "Rostite",
        "Хлорбартонит": "Chlorbartonite",
        "Витусит-(Ce)": "Vitusite-(Ce)",
        "Перцевит-OH": "Percevit -OH",
        "Кассит": "Cassite",
        "Индерит": "Inderite",
        "Танеллит": "Tanellite",
        "Тимрозеит": "Timrozeite",
        "Торнеит": "Torneite",
        "Пумпеллиит-Al": "Pumpelliite-Al",
        "Шортит": "Shortite",
        "Кариохроит": "Karyochroite",
        "Метациннабарит": "Metacinnabarite",
        "Охотскит": "Okhotskite",
        "Ньюбериит": "Newberyite",
        "Тефроит": "Tephroite",
        "Эвкриптит": "Eucryptite",
        "Тахеренит": "Tacherenite",
        "Карбобыстрит": "Carbobystrite",
        "Свейнбергит": "Sweinbergite",
        "Мегоит": "Megoite",
        "Павловскиит": "Pawlowskiite",
        "Кордилит-(La)": "Cordylite-(La)",
        "Коттенхаймит": "Cottenheimite",
        "Раббиттит": "Rabbittite",
        "Анаурипигмент": "Anauripigment",
        "Ильваит": "Ilvaite ",
        "Пентагидроборит": "Pentahydroborite",
        "Бледит": "Bledit",
        "Уиллемсеит": "Willemseite",
        "Раслакит": "Raslakite",
        "Мелантерит": "Melanterite",
        "Селадонит": "Celadonite",
        "Ланштайнит": "Lahnsteinite",
        "Манганоквадратит": "Manganoquadratite",
        "Хуангодойит": "Huangodoyite",
        "Бенторит": "Bentorite",
        "Хаулеит": "Hauleite",
        "Осумилит": "Osumilite",
        "Полигалит": "Polyhalite",
        "Кульсонит": "Kulsonite",
        "Синхизит-(Y)": "Synchisite-(Y)",
        "Ларозит": "Larosite ",
        "Арангасит": "Arangasite",
        "Ферримолибдит": "Ferrimolybdite",
        "Денисовит": "Denisovite",
        "Нунканбахит": "Nunkanbahite",
        "Рихтерит": "Richterite",
        "Пийпит": "Piipit",
        "Шаттукит": "Shattukite",
        "Парсеттенсит": "Parsettensite",
        "Кариопилит": "Karyopylite",
        "Гаусманнит": "Hausmannite",
        "Аллеганит": "Alleganite",
        "Лабрадорит": "Labradorite",
        "Ферсманит": "Fersmanite",
        "Троилит": "Troilite",
        "Конихальцит": "Conichalcite",
        "Антимонит": "Antimonite",
        "Амминеит": "Ammineite",
        "Атенсиоит": "Atensioite",
        "Санборнит": "Sanbornite",
        "Макдональдит": "McDonaldite",
        "Обертит": "Obertite",
        "Набимусаит": "Nabimusaite",
        "Санроманит": "Sanromanite",
        "Гоудейит": "Goudeyite",
        "Вендидаит": "Vendidaite ",
        "Хризоталлит": "Chrysotallit",
        "Бисмоклит": "Bismoklit",
        "Палыгорскит": "Palygorskite",
        "Петшекит": "Petsshekit",
        "Брошантит": "Brochantite",
        "Коэсит": "Coesite",
        "Вигришинит": "Vigrishinite",
        "Бабингтонит": "Babingtonite",
        "Амичит": "Amicite",
        "Беллинджерит": "Bellingerite",
        "Хайнесит": "Haynesite",
        "Сантабарбараит": "Santabarbaraite",
        "Меллицинкалит": "Mellicincalite",
        "Шиловит": "Shilovite",
        "Юсуповит": "Yusupovite",
        "Романорловит": "Romanorlovite",
        "Карповит": "Karpovit",
        "Карналлит": "Carnallite",
        "Альфорсит": "Alforsite",
        "Леманскиит": "Lemanskiite",
        "Алюминококимбит": "Aluminokokimbit",
        "Планерит": "Planerite",
        "Варисцит": "Variscite",
        "Арсеногорсейксит": "Arsenogorseixite",
        "Бетпакдалит-CaCa": "Betpakdalite-CaCa",
        "Захерит": "Zacherite",
        "Квадратит": "Kvadratite",
        "Мусковит-1M": "Muscovite-1M",
        "Россовскиит": "Rossovskiite",
        "Митридатит": "Mithridatite",
        "Купротунгстит": "Cuprotungstite",
        "Розенханит": "Rosenhanite",
        "Колумбит-(Mg)": "Columbite-(Mg)",
        "Церианит-(Ce)": "Cerianite-(Ce)",
        "Вокелинит": "Wokelinite",
        "Криптофиллит": "Cryptophyllite",
        "Глаголевит": "Glagolevit",
        "Фукалит": "Fucalite",
        "Стибарсен": "Stibarsen",
        "Секанинаит": "Sekaninaite",
        "Макальпинеит": "Macalpineite",
        "Хьюмалит": "Humalite",
        "Пробертит": "Probertite",
        "Урусовит": "Urusovite",
        "Сколецит": "Scolecite",
        "Антигорит": "Antigorite",
        "Ремондит-(Ce)": "Remondite-(Ce) ",
        "Каллагханит": "Callaghanite",
        "Нордстрандит": "Nordstrandite",
        "Арсениосидерит": "Arseniosiderite",
        "Фольбортит": "Folbortite",
        "Роскоэлит": "Roscoelite",
        "Алюминокопиапит": "Aluminocopiapite",
        "Магнезиохромит": "Magnesiochromite",
        "Циркофиллит": "Zircophyllite",
        "Пентландит": "Pentlandite",
        "Плюмбогуммит": "Plumbogummite",
        "Нафоит": "Nafoite",
        "Дакиардит-Ca": "Dakiardite-Ca ",
        "Руаит": "Ruait",
        "Переттиит-(Y)": "Perettiit-(Y)",
        "Бренкит": "Brenkit",
        "Феррьерит-K": "Ferrierite-K",
        "Вантгоффит": "Vanthoffite",
        "Ориентит": "Orientite",
        "Кричтонит": "Crichtonite",
        "Владимирит": "Vladimirite",
        "Баритолампрофиллит": "Baritolamprophyllite",
        "Гидроксилклиногумит": "Hydroxylclinohumite",
        "Клиноэнстатит": "Clinoenstatite",
        "Гидрокалюмит": "Hydrocalumite",
        "Афвиллит": "Afwillite",
        "Ремерит": "Remerite",
        "Магнезиовольтаит": "Magnesiovoltaite",
        "Тамаругит": "Tamarugit",
        "Беллоит": "Belloite",
        "Натроярозит": "Natrojarosite",
        "Шварцембергит": "Schwarzembergite",
        "Гордаит": "Gordaite",
        "Лондонит": "Londonite",
        "Креднерит": "Krednerite",
        "Гарианселлит": "Hariansellite",
        "Банальсит": "Banalsite",
        "Луешит": "Luesite",
        "Штренгит": "Strengite",
        "Жедрит": "Jedrite",
        "Миметит": "Mimetite",
        "Каолинит": "Kaolinite",
        "Энстатит": "Enstatite",
        "Сперрилит": "Sperrylite",
        "Талнахит": "Talnakhit",
        "Вилуит": "Viluit",
        "Партеит": "Partheite",
        "Алюмовезувиан": "Alumovesuviane",
        "Пижонит": "Pijonite",
        "Ярозит": "Yarosite",
        "Батисит": "Batisite",
        "Тасекит": "Tasekit",
        "Фердоусиит": "Ferdousiite",
        "Паризит-(La)": "Parisite-(La) ",
        "Оксидравит": "Oxidravite",
        "Ферроферригорнблендит": "Ferroferrigornblendite",
        "Монтмориллонит": "Montmorillonite",
        "Жиродит": "Gyrodite",
        "Фогоит-(Y)": "Fogoite-(Y)",
        "Дюранюзит": "Duranusite",
        "Афганит": "Afghanite",
        "Гиббсит": "Gibbsite",
        "Хотсонит": "Hotsonite",
        "Хантит": "Huntite",
        "Коллинсит": "Collinsite",
        "Ганксит": "Ganksit",
        "Пеллиит": "Pelliit",
        "Магнезиоканутит": "Magnesiocanutite",
        "Цинкокопиапит": "Zincocopyapite",
        "Роценит": "Rocenite",
        "Тоберморит": "Tobermorite",
        "Шарыгинит": "Sharyginite",
        "Аммониоциппеит": "Ammoniocyppeite",
        "Фторрихтерит": "Fluorrichterite",
        "Уотерхаузит": "Waterhousesite",
        "Бианкит": "Biankite",
        "Дитрихит": "Dietrichite",
        "Фаматинит": "Famatinite",
        "Шабазит-(Ca)": "Chabazite-(Ca) ",
        "Штейнметцит": "Steinmettzite",
        "Пикрофармаколит": "Picropharmacolite",
        "Клинтонит": "Clintonite",
        "Гримзелит": "Grimzelite",
        "Тунгусит": "Tungusite",
        "Калиймагнезиоарфведсонит": "Potassium magnesioarfvedsonite",
        "Умбит": "Umbit",
        "Лобановит": "Lobanovit",
        "Шафрановскит": "Shafranovskite",
        "Зорит": "Zorite",
        "Каннанит": "Cannanite",
        "Хризотил": "Chrysotile",
        "Инцзянит": "Yingjianite",
        "Рубоит": "Ruboite",
        "Натрон": "Natron",
        "Дальнегорскит": "Dalnegorskite",
        "Эласмохлоит": "Elasmochloite",
        "Торианит": "Torianite",
        "Тадеуит": "Tadeuit",
        "Сульфгидрилбыстрит": "Sulfhydrylbystrite",
        "Фойтит": "Foytite",
        "Хлорапатит": "Chlorapatite",
        "Касаткинит": "Kasatkinite",
        "Манаевит-(Ce)": "Manaevit-(Ce) ",
        "Фальгарит": "Falgarite",
        "Спионкопит": "Spionkopit",
        "Белогубит": "Belogubite",
        "Бавенит": "Bavenite",
        "Ковеллин": "Covelline",
        "Говлит": "Howlite",
        "Магнезиогастингсит": "Magnesiogastingsite",
        "Виикит": "Viikit",
        "Квинтинит": "Quintinite",
        "Ридмерджнерит": "Ridmerjnerite",
        "Тяньшанит": "Tianshanite",
        "Метароссит": "Metarossite",
        "Варвикит": "Warwickite",
        "Аргентотеннантит": "Argentotennantite",
        "Хаттонит": "Hattonite",
        "Литиофиллит": "Lithiophyllite",
        "Парамонтрозеит": "Paramontroseite",
        "Черновит-(Y)": "Chernovit-(Y)",
        "Бритолит-(Y)": "Britolite-(Y)",
        "Гердерит": "Herderite",
        "Куретонит": "Curetonite",
        "Сирлезит": "Sirlesite",
        "Боскардинит": "Boscardinite",
        "Йоаннеумит": "Joanneumite",
        "Дальнегроит": "Dalnegroite",
        "Зоарит": "Zoarite",
        "Экринсит": "Ekrinsite",
        "Шабурнеит": "Shaburneite",
        "Стронциоджоакинит": "Strontiojoakinite",
        "Ниобоэшинит-(Y)": "Nioboeshinite-(Y)",
        "Сандженароит": "Sangenaroite",
        "Волынскит": "Volynskite",
        "Стистаит": "Stistaite",
        "Лопарит-(Ce)": "Loparite-(Ce)",
        "Стевенсит": "Stevensite",
        "Джулголдит-(Fe2+)": "Dzhulgoldite-(Fe2+)",
        "Быстрит": "Bystrit",
        "Иоганнит": "Iohannit",
        "Маргарит": "Margarite",
        "Клейнит": "Cleinite",
        "Терлингуакрикит": "Terlinguakrikite",
        "Цирсилит-(Ce)": "Cirsilite-(Ce)",
        "Тинтикит": "Tinticite",
        "Трифилин": "Trifilin",
        "Прозопит": "Prosopite",
        "Гидроталькит-2H": "Hydrotalcite -2H",
        "Уранополикраз": "Uranopolycrase",
        "Алланит-(Ce)": "Allanite-(Ce)",
        "Парапьерротит": "Parapierrotite",
        "Алекскузнецовит-(La)": "Alekskuznetsovite-(La)",
        "Алекскузнецовит-(Ce)": "Alekskuznetsovite-(Ce)",
        "Рабдоборит-(Mo)": "Rabdoborite-(Mo)",
        "Попугаеваит": "Popugaevait",
        "Манганобадаловит": "Manganobadalovite ",
        "Гидрокеноэлсмореит": "Hydrokoenoelsmoreite",
        "Лейкофан": "Leucophane",
        "Поит": "Poite",
        "Тетраэдрит-(Zn)": "Tetrahedrite-(Zn)",
        "Куфарит": "Kufarite",
        "Шеферит": "Sheferite",
        "Бадаловит": "Badalovite",
        "Вюртцит-2H": "Wurtzite-2H",
        "Бура": "Borax",
        "Гейкилит": "Geykilite",
        "Сода": "Soda",
        "Колумбит": "Columbite",
        "Магнезиорибекит": "Magnesioribekite",
        "Вишневит": "Vishnevit",
        "Зусманит": "Zusmanite",
        "Лавсонит": "Lawsonite",
        "Кернит": "Kernite",
        "Клиноклаз": "Clinoclase",
        "Бикитаит": "Bikitaite",
        "Аксинит-(Mn)": "Axinite-(Mn)",
        "Фторапофиллит-(Cs)": "Fluorapophyllite-(Cs) ",
        "Шрекингерит": "Schreckingerite",
        "Раджит": "Rajit",
        "Парателлурит": "Paratellurite",
        "Шамозит": "Chamosite",
        "Петалит": "Petalite",
        "Калиевая селитра": "Potassium nitrate",
        "Кельтит": "Keltite",
        "Озерновскит": "Ozernovskite",
        "Коррейяневесит": "Correyanevesite",
        "Теннантит-Zn": "Tennantite-Zn",
        "Ландауит": "Landauite",
        "Буссенготит": " Bussengotite",
        "Велоганит": "Veloganite",
        "Сульфогалит": "Sulfogalite",
        "Дяоюидаоит": "Diaoyuidaoite",
        "Цианотрихит": "Cyanotrichite",
        "Циркелит": "Cirkelite",
        "Риннеит": "Rinneite",
        "Бромаргирит": "Bromargyrite",
        "Нейборит": "Neiborite",
        "Криолитионит": "Cryolithionite",
        "Веберит": "Weberite",
        "Ральстонит": "Ralstonite",
        "Тихоненковит": "Tikhonenkovite",
        "Ярлит": "Yarlite",
        "Авогадрит": "Avogadrite",
        "Пахнолит": "Pahnolite",
        "Стенонит": "Stenonite",
        "Геарксутит": "Gearxutite",
        "Хиолит": "Chiolite",
        "Томсенолит": "Tomsenolite",
        "Анкерит": "Ankerite",
        "Розазит": "Rosasite",
        "Гидроцинкит": "Hydrozincite",
        "Монтбрейит": "Montbreuite",
        "Натроалунит": "Natroalunite",
        "Девиллин": " Devillin",
        "Кокимбит": "Coquimbit",
        "Спанголит": "Spangolith",
        "Лангбейнит": "Langbeinite",
        "Плюмбоярозит": "Plumboyarosite",
        "Каинит": "Cainite",
        "Квасцы-(K)": "Alum-(K)",
        "Галотрихит": "Halotrichite",
        "Пиккерингит": "Pickeringite",
        "Алюминит": "Aluminite",
        "Ботриоген": "Botryogen",
        "Копиапит": "Copiapite",
        "Форнасит": "Fornasite",
        "Лейцит": "Leucite",
        "Вайракит": "Wairakit ",
        "Уссингит": "Ussingite",
        "Жисмондин": "Gismondine",
        "Стеллерит": "Stellerite",
        "Ломонтит": "Lomontite",
        "Эрионит": "Erionite",
        "Тетранатролит": "Tetranatrolite",
        "Феррьерит": "Ferrierite",
        "Умангит": "Umangit",
        "Даналит": "Danalit",
        "Ловдарит": "Lovdarite",
        "Баотит": "Baotite",
        "Ильмайокит": "Ilmayokite",
        "Тиманнит": "Timannite",
        "Зуниит": "Zuniite",
        "Лайтакарит": "Laitakarit",
        "Коашвит": "Koashvit",
        "Параумбит": "Paraumbit",
        "Лемуанит": "Lemuanite",
        "Миларит": "Milarite",
        "Лейфит": "Leyfit",
        "Торит": "Thorite",
        "Торогуммит": "Torogummit",
        "Шорломит": "Shorlomite",
        "Никельскуттерудит": "Nickelskutterudite",
        "Дигенит": "Digenite",
        "Пьемонтит": "Piedmontite",
        "Сейдозерит": "Seidozerite",
        "Ринкит": "Rinkite",
        "Ниокалит": "Niocalite",
        "Келдышит": "Keldyshite",
        "Кентролит": "Kentrolite",
        "Ненадкевичит": "Nenadkevichite",
        "Армстронгит": "Armstrongite",
        "Канасит": "Kanasite",
        "Юкспорит": "Yuksporite",
        "Планшеит": "Plansheite",
        "Холтит": "Holtite",
        "Магнезиоастрофиллит": "Magnesioastrophyllite",
        "Манганпиросмалит": "Manganpyrosmalite",
        "Хлоритоид": "Chloritoid",
        "Дельхайелит": "Delkhayelit",
        "Гидродельхайелит": "Hydrodelkhayelit",
        "Маунтинит": "Mountainite",
        "Раит": "Raite",
        "Федорит": "Fedorite",
        "Стильпномелан": "Stilpnomelane",
        "Ректорит": "Rectorite",
        "Тосудит": "Tosudite",
        "Алуштит": "Alushtite",
        "Судоит": "Sudoit",
        "Метагаллуазит": "Metagalloysite",
        "Накрит": "Nakrite",
        "Мусковит-2Mё": "Muscovite-2Me",
        "Хромфиллит": "Chromophyllite",
        "Сидерофиллит": "Siderophyllite",
        "Полилитионит": "Polylythionite",
        "Бромеллит": "Bromellite",
        "Периклаз": "Periclase",
        "Герцинит": "Hercynite",
        "Таафеит": "Taafheite",
        "Хибонит": "Hibonite",
        "Бариопирохлор": "Bariopyrochlore",
        "Полидимит": "Polydymite ",
        "Биндгеймит": "Bindheimite",
        "Камасит": "Kamasite",
        "Платтнерит": "Plattnerite",
        "Прайдерит": "Priderite",
        "Симпсонит": "Simpsonite",
        "Сервантит": "Servantite",
        "Романешит": "Romaneshite",
        "Монтроидит": "Montroidite",
        "Сенармонтит": "Senarmontite",
        "Ниоболопарит": "Nioboloparite",
        "Таусонит": "Tausonite",
        "Эшинит-(Y)": "Eshinite-( Y)",
        "Эшинит-(Nd)": "Eshinite-(Nd)",
        "Цезстибтантит": "Cezstibtantite",
        "Иксиолит": "Ixiolit",
        "Ферроколумбит": "Ferrocolumbite",
        "Монтрозеит": "Montroseite",
        "Байерит": "Bayerite",
        "Бемит": "Boehmite",
        "Бернессит": "Bernessite",
        "Айдырлит": "Aidirlite",
        "Пироаурит": "Pyroaurite",
        "Меймакит": "Meimakit ",
        "Гидротунгстит": "Hydrotungstite",
        "Русселит": "Rousselit",
        "Харкерит": "Harkerite",
        "Суанит": "Suanite",
        "Пинноит": "Pinnoite",
        "Индерборит": "Inderborite",
        "Люнебургит": "Luneburgite",
        "Мейергофферит": "Meyergofferite",
        "Берцелиит": "Berzelyite",
        "Фармакосидерит": "Pharmacosiderite",
        "Буковскиит": "Bukowskiite",
        "Аннабергит": "Annabergite",
        "Гернесит": "Gernesite",
        "Моктесумит": "Moctesumite",
        "Маккейит": "McKeithite",
        "Тангеит": "Tangeite",
        "Корвусит": "Corvusite",
        "Бокит": "Bokite",
        "Монтебразит": "Montebrasite",
        "Эосфорит": "Eosphorite",
        "Анапаит": "Anapaite",
        "Чилдренит": "Childrenite",
        "Парашольцит": "Parasholcite",
        "Нефедовит": "Nefedovite",
        "Cиклерит": "Cyclerite",
        "Гетерозит": "Heterosite",
        "Ферроуиллиит": "Ferrowilliite",
        "Бразилианит": "Brazilianite",
        "Цинколибетенит": "Zinkolibetenite",
        "Аугелит": "Augelite",
        "Фосфогедифан": "Phosphogedifane",
        "Крандаллит": "Crandallite",
        "Смирновскит": "Smirnovskite",
        "Гюролит": "Gyurolite",
        "Фторвавеллит": "Fluorovallite",
        "Глюцин": "Glucinite",
        "Заназиит": "Zanaziite",
        "Стронциоапатит": "Strontioapatite",
        "Сейдит-(Ce)": "Seydite-(Ce) ",
        "Таранакит": "Taranakit",
        "Фаустит": "Faustite",
        "Миниюлит": "Miniyulite",
        "Струвит": "Struvite",
        "Прустит": "Proustite",
        "Плагионит": "Plagionite",
        "Сакураиит": "Sakuraiite",
        "Люцонит": "Luzonite",
        "Полибазит": "Polybasite",
        "Белянкинит": "Belyankinite",
        "Эвансит": "Evansite",
        "Карпатит": "Carpatite",
        "Уэвеллит": "Whewellite",
        "Аллофан": "Allofan",
        "Твалчрелидзеит": "Tvalchrelidzeit",
        "Бончевит": "Bonchevit",
        "Хаммарит": "Hammarite",
        "Кобеллит": "Cobellite",
        "Лиллианит": "Lillianite",
        "Акташит": "Aktashite",
        "Ливингстонит": "Livingstonite",
        "Тунгстенит-2H": "Tungstenite-2H",
        "Молибденит-3R": "Molybdenite-3R",
        "Бравоит": "Bravoite",
        "Звягинит": "Zvyaginite",
        "Расвумит": "Rasvumite",
        "Надорит": "Nadorite",
        "Гейландит-Ca": "Heulandite-Ca",
        "Гоннардит": "Gonnardite",
        "Маршит": "Marshite",
        "Манаксит": "Manaksite",
        "Феррисапонит": "Ferrisaponite",
        "Гмелинит-Na": "Gmelinite-Na",
        "Ферроактинолит": "Ferroactinolite",
        "Сребродольскит": "Srebrodolskite",
        "Ромаркит": "Romarkite",
        "Карбонатапатит": "Carbonatapatite",
        "Сфалерит по вюртциту": "Sphalerite on wurtzite",
        "Гематит по древесине": "Hematite on wood",
    }

    def create_ann(image_path):
        labels = []
        tags = []

        folder = sly.Tag(folder_meta)
        tags.append(folder)

        image_np = sly.imaging.image.read(image_path)[:, :, 0]
        img_height = image_np.shape[0]
        img_wight = image_np.shape[1]

        image_name = get_file_name_with_ext(image_path)

        mineral_name_value = name_to_mineral_name.get(image_name)
        if mineral_name_value is not None:
            mineral_name = sly.Tag(name, value=mineral_name_value)
            tags.append(mineral_name)

        size_value = name_to_size.get(image_name)
        if size_value is not None:
            size = sly.Tag(size_sm, value=size_value)
            tags.append(size)

        mvid_value_rus = name_to_mvid.get(image_name)
        if mvid_value_rus is not None:
            mvid_value_eng = rus_to_eng_names[mvid_value_rus]
            mvid = sly.Tag(mvid_meta, value=mvid_value_eng)
            tags.append(mvid)

        desc_value_eng = name_to_description.get(image_name)
        if desc_value_eng != "":
            dsc = sly.Tag(dsc_meta, value=desc_value_eng[:254])
            tags.append(dsc)

        if subfolder == "segm":
            mask_path = f"{masks_dir}/{get_file_name_with_ext(image_path)}"
            if file_exists(mask_path):
                ann_np = sly.imaging.image.read(mask_path)[:, :, :]
                ann_np = fix_masks(ann_np)[:, :, 0]

                obj_mask = ann_np == 255
                curr_bitmap = sly.Bitmap(obj_mask)
                curr_label = sly.Label(curr_bitmap, name_to_class["a mineral"])
                labels.append(curr_label)

            return sly.Annotation(img_size=(img_height, img_wight), labels=labels, img_tags=tags)

        data = name_to_bboxes.get(image_name)
        if data is not None:
            for curr_data in data:
                bboxes = curr_data["box"]
                confidence_value = float(curr_data["confidence"])
                confidence = sly.Tag(confidence_meta, value=confidence_value)
                class_name = curr_data["label"]
                left = int((bboxes[0]) * img_wight)
                right = int((bboxes[2]) * img_wight)
                top = int((bboxes[1]) * img_height)
                bottom = int((bboxes[3]) * img_height)
                rectangle = sly.Rectangle(top=top, left=left, bottom=bottom, right=right)
                label = sly.Label(rectangle, name_to_class[class_name], tags=[confidence])
                labels.append(label)

        return sly.Annotation(img_size=(img_height, img_wight), labels=labels, img_tags=tags)

    name_to_class = {
        "a stone": sly.ObjClass("stone", sly.Rectangle),
        "a mineral": sly.ObjClass("mineral", sly.AnyGeometry),
        "a crystal": sly.ObjClass("crystal", sly.Rectangle),
        "a gem": sly.ObjClass("gem", sly.Rectangle),
        "a rock": sly.ObjClass("rock", sly.Rectangle),
        "a mineral ore": sly.ObjClass("mineral ore", sly.Rectangle),
    }

    size_sm = sly.TagMeta("size_sm", sly.TagValueType.ANY_NUMBER)
    name = sly.TagMeta("name", sly.TagValueType.ANY_STRING)
    confidence_meta = sly.TagMeta("confidence", sly.TagValueType.ANY_NUMBER)
    mvid_meta = sly.TagMeta("mvid", sly.TagValueType.ANY_STRING)
    dsc_meta = sly.TagMeta("dsc", sly.TagValueType.ANY_STRING)

    syst = sly.TagMeta("syst", sly.TagValueType.NONE)
    mest = sly.TagMeta("mest", sly.TagValueType.NONE)
    op = sly.TagMeta("op", sly.TagValueType.NONE)
    cryst = sly.TagMeta("cryst", sly.TagValueType.NONE)
    pdk = sly.TagMeta("PDK", sly.TagValueType.NONE)
    stepanov = sly.TagMeta("stepanov", sly.TagValueType.NONE)
    meteor = sly.TagMeta("meteor", sly.TagValueType.NONE)
    segm = sly.TagMeta("segm", sly.TagValueType.NONE)

    folder_to_tag = {
        "segm": segm,
        "1_syst": syst,
        "2_mest": mest,
        "3_op": op,
        "4_cryst": cryst,
        "5_PDK": pdk,
        "7_stepanov": stepanov,
        "10_meteor": meteor,
    }

    project = api.project.create(workspace_id, project_name, change_name_if_conflict=True)
    meta = sly.ProjectMeta(
        obj_classes=list(name_to_class.values()),
        tag_metas=[
            size_sm,
            name,
            confidence_meta,
            segm,
            syst,
            mest,
            op,
            cryst,
            pdk,
            stepanov,
            meteor,
            mvid_meta,
            dsc_meta,
        ],
    )
    api.project.update_meta(project.id, meta.to_json())

    name_to_mineral_name = {}
    name_to_bboxes = {}
    name_to_size = {}
    name_to_mvid = {}
    name_to_description = {}

    with open(bboxes_path, "r") as file:
        csvreader = csv.reader(file)
        for idx, row in enumerate(csvreader):
            if idx == 0:
                continue
            name_to_mineral_name[row[1].split("/")[-1]] = row[9]
            name_to_bboxes[row[1].split("/")[-1]] = ast.literal_eval(str(row[14]))
            name_to_description[row[1].split("/")[-1]] = row[12]

    with open(sizes_path, "r") as file:
        csvreader = csv.reader(file)
        for idx, row in enumerate(csvreader):
            if idx == 0:
                continue
            name_to_size[row[0].split("/")[-1]] = float(row[3])
            if len(row[2]) > 0:
                name_to_mvid[row[0].split("/")[-1]] = row[2]

    for subfolder in ["segm"] + os.listdir(all_images_pathes):
        dataset = api.dataset.create(project.id, subfolder, change_name_if_conflict=True)
        folder_meta = folder_to_tag[subfolder]

        images_dir = os.path.join(all_images_pathes, subfolder)
        if subfolder == "segm":
            images_dir = segm_images_path

        images_pathes = (
            glob.glob(images_dir + "/*/*.jpg")
            + glob.glob(images_dir + "/*.jpg")
            + glob.glob(images_dir + "/*.JPG")
            + glob.glob(images_dir + "/*/*/*.jpg")
            + glob.glob(images_dir + "/*/*.JPG")
        )

        progress = sly.Progress("Create dataset {}".format(subfolder), len(images_pathes))

        for img_pathes_batch in sly.batched(images_pathes, batch_size=batch_size):
            if subfolder not in ["1_syst", "2_mest"]:
                img_names_batch = [get_file_name_with_ext(im_path) for im_path in img_pathes_batch]
            else:
                img_names_batch = [
                    im_path.split("/")[-2] + "_" + get_file_name_with_ext(im_path)
                    for im_path in img_pathes_batch
                ]

            img_infos = api.image.upload_paths(dataset.id, img_names_batch, img_pathes_batch)
            img_ids = [im_info.id for im_info in img_infos]

            anns = [create_ann(image_path) for image_path in img_pathes_batch]
            api.annotation.upload_anns(img_ids, anns)

            progress.iters_done_report(len(img_names_batch))
    return project
